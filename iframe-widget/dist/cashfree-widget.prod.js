(()=>{let e,t,a=!1;window.addEventListener("load",(function(){if(a)return;const t=document.getElementById("cashfree-widget");if(!t)return;const n=document.getElementById("cf-iframe");n&&n.parentElement.removeChild(n);const s=document.createElement("iframe");("no"===t.dataset.isoffers&&"no"===t.dataset.ispaylater&&"no"===t.dataset.isemi||!t.dataset.amount||""===t.dataset.amount||t.dataset.appid.includes("data")||""===t.dataset.appid)&&(s.style.display="none"),s.src="https://cf-widget-frame.cashfree.com/",s.id="cf-iframe",s.loading="eager",s.style.width="100%",s.style.height="100%",s.style.border="none",s.onload=async()=>{e=await(async()=>{if("no"===t.dataset.isoffers&&"no"===t.dataset.ispaylater&&"no"===t.dataset.isemi||!t.dataset.amount||""===t.dataset.amount||t.dataset.appid.includes("data")||""===t.dataset.appid)return;const e=await fetch(`https://receiver.cashfree.com/pgnextgenconsumer/uiapi/external/merchants/offers?appId=${t.dataset.appid}&amount=${t.dataset.amount}`,{method:"POST",body:JSON.stringify({isOffer:"yes"===t.dataset.isoffers,isPayLater:"yes"===t.dataset.ispaylater,isEMIPlans:t.dataset.amount>2500&&"yes"===t.dataset.isemi}),headers:{"Content-type":"application/json"}});return await e.json()})(),(e.statusCode||0===e.offerDetails.offers.length&&0===e.payLaters.length&&0===e.emiDetails.ccEMIPlans.length&&0===e.emiDetails.dcEMIPlans.length)&&(s.style.display="none"),s.contentWindow.postMessage({frameDataObj:e,amount:t.dataset.amount,appId:t.dataset.appid},"https://cf-widget-frame.cashfree.com/")},t.appendChild(s);const o=document.getElementById("cf-iframe-details");o&&o.parentElement.removeChild(o);const d=document.createElement("iframe");d.src="https://cf-widget-detailframe.cashfree.com/",d.id="cf-iframe-details",d.loading="eager",d.style.width="100%",d.style.height="100vh",d.style.border="none",d.style.zIndex="99999",d.style.position="fixed",d.style.top="0px",d.style.left="0px",d.style.display="none",t.appendChild(d),window.onmessage=function(a){a.data.isModelOpen&&(d.style.display="block",d.onload=()=>{d.contentWindow.postMessage({opentab:a.data.opentab,amount:t.dataset.amount,frameDataObj:e},"https://cf-widget-detailframe.cashfree.com/")},t.appendChild(d)),a.data.isModelClose&&(document.getElementById("cf-iframe-details").style.display="none")}})),window.CF_Widget=function({amount:n,shopId:s}){a=!0;let o=!1;return{load:function(){if(o)return;o=!0;const a=document.getElementById("cashfree-widget");if(!a)return;const d=document.getElementById("cf-iframe");d&&d.parentElement.removeChild(d);const i=document.createElement("iframe");i.src="https://cf-widget-frame.cashfree.com/",i.id="cf-iframe",i.style.height="100%",i.style.border="none",i.loading="eager",i.onload=async()=>{[e,t]=await(async()=>{const[e,t]=await Promise.all([fetch(`https://receiver.cashfree.com/pgnextgenconsumer/uiapi/external/merchant/widget/offer?shopId=${s}&amount=${n}`,{method:"GET",headers:{"Content-type":"application/json"}}),fetch(`http://localhost:3000/uiapi/external/merchant/widget/settings?shopId=${s}`,{method:"GET",headers:{"Content-type":"application/json"}})]);return[await e.json(),await t.json()]})(),(e.statusCode||0===e.offerDetails.offers.length&&0===e.payLaters.length&&0===e.emiDetails.ccEMIPlans.length&&0===e.emiDetails.dcEMIPlans.length)&&(i.style.display="none"),i.contentWindow.postMessage({frameDataObj:e,amount:n,appId:"",widgetConfigObj:t},"https://cf-widget-frame.cashfree.com/")},a.appendChild(i);const l=document.getElementById("cf-iframe-details");l&&l.parentElement.removeChild(l);const r=document.createElement("iframe");r.src="https://cf-widget-detailframe.cashfree.com/",r.id="cf-iframe-details",r.loading="eager",r.style.width="100%",r.style.height="100vh",r.style.border="none",r.style.zIndex="99999",r.style.position="fixed",r.style.top="0px",r.style.left="0px",r.style.display="none",a.appendChild(r),window.onmessage=function(t){t.data.isModelOpen&&(r.style.display="block",r.onload=()=>{r.contentWindow.postMessage({opentab:t.data.opentab,amount:n,frameDataObj:e},"https://cf-widget-detailframe.cashfree.com/")},a.appendChild(r)),t.data.isModelClose&&(document.getElementById("cf-iframe-details").style.display="none")}}}}})();